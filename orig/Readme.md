The original code before refactoring and improving
